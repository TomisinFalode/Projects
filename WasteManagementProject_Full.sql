
-- ============================
-- FULL SQL SCRIPT: WASTE MANAGEMENT PROJECT
-- ============================

-- 1. CREATE TABLES
CREATE TABLE Cities (
    city_id INT PRIMARY KEY,
    city_name VARCHAR(50),
    population INT
);

CREATE TABLE WasteTypes (
    waste_type_id INT PRIMARY KEY,
    waste_name VARCHAR(50)
);

CREATE TABLE WasteCollection (
    collection_id INT PRIMARY KEY,
    city_id INT,
    waste_type_id INT,
    collection_date DATE,
    amount_kg DECIMAL(10,2),
    collected_by VARCHAR(50),
    FOREIGN KEY (city_id) REFERENCES Cities(city_id),
    FOREIGN KEY (waste_type_id) REFERENCES WasteTypes(waste_type_id)
);

CREATE TABLE RecyclingFacilities (
    facility_id INT PRIMARY KEY,
    facility_name VARCHAR(50),
    city_id INT,
    waste_type_id INT,
    capacity_kg DECIMAL(10,2),
    FOREIGN KEY (city_id) REFERENCES Cities(city_id),
    FOREIGN KEY (waste_type_id) REFERENCES WasteTypes(waste_type_id)
);

-- 2. INSERT DATA

-- Cities
INSERT INTO Cities VALUES
(1, 'St. Johns', 110000),
(2, 'Mount Pearl', 35000),
(3, 'Corner Brook', 20000),
(4, 'Gander', 12000),
(5, 'Grand Falls-Windsor', 14000);

-- Waste Types
INSERT INTO WasteTypes VALUES
(1, 'Organic'),
(2, 'Plastic'),
(3, 'Paper'),
(4, 'Glass'),
(5, 'E-Waste');

-- Waste Collection (200 records)
INSERT INTO WasteCollection VALUES
(1, 1, 1, '2025-02-05', 282.65, 'Team 2'),
(2, 1, 5, '2025-01-12', 610.97, 'Team 1'),
(3, 1, 1, '2025-01-28', 271.03, 'Team 5'),
(4, 1, 5, '2025-01-26', 730.22, 'Team 5'),
(5, 4, 2, '2025-02-27', 609.8, 'Team 1'),
(6, 2, 4, '2025-02-13', 313.98, 'Team 2'),
(7, 3, 1, '2025-01-12', 410.93, 'Team 3'),
(8, 3, 5, '2025-02-03', 816.77, 'Team 4'),
(9, 5, 1, '2025-02-18', 124.86, 'Team 3'),
(10, 5, 3, '2025-03-15', 232.67, 'Team 1'),
(11, 1, 2, '2025-02-07', 985.96, 'Team 2'),
(12, 1, 4, '2025-02-05', 480.74, 'Team 3'),
(13, 2, 3, '2025-02-15', 249.03, 'Team 3'),
(14, 1, 5, '2025-03-23', 212.58, 'Team 2'),
(15, 2, 4, '2025-02-18', 306.45, 'Team 5'),
(16, 2, 3, '2025-01-08', 267.6, 'Team 1'),
(17, 3, 4, '2025-02-04', 112.88, 'Team 5'),
(18, 3, 2, '2025-03-25', 524.27, 'Team 4'),
(19, 2, 3, '2025-01-18', 284.3, 'Team 5'),
(20, 5, 3, '2025-03-16', 457.01, 'Team 5'),
(21, 4, 3, '2025-01-29', 997.46, 'Team 2'),
(22, 5, 4, '2025-01-12', 767.99, 'Team 1'),
(23, 2, 2, '2025-03-29', 451.05, 'Team 1'),
(24, 4, 4, '2025-03-18', 996.32, 'Team 5'),
(25, 3, 5, '2025-01-02', 696.27, 'Team 1'),
(26, 5, 3, '2025-03-24', 373.17, 'Team 3'),
(27, 4, 2, '2025-02-28', 53.08, 'Team 3'),
(28, 5, 2, '2025-03-06', 917.0, 'Team 3'),
(29, 5, 5, '2025-01-26', 195.2, 'Team 2'),
(30, 5, 5, '2025-01-01', 619.0, 'Team 4'),
(31, 1, 1, '2025-02-16', 884.79, 'Team 3'),
(32, 2, 1, '2025-01-31', 884.11, 'Team 1'),
(33, 1, 4, '2025-01-09', 979.09, 'Team 5'),
(34, 2, 2, '2025-03-26', 501.52, 'Team 5'),
(35, 2, 3, '2025-03-09', 878.81, 'Team 4'),
(36, 2, 5, '2025-03-30', 241.09, 'Team 3'),
(37, 4, 3, '2025-02-26', 904.63, 'Team 4'),
(38, 1, 2, '2025-01-29', 110.82, 'Team 1'),
(39, 5, 5, '2025-01-30', 609.02, 'Team 1'),
(40, 1, 1, '2025-01-30', 114.03, 'Team 1'),
(41, 3, 1, '2025-03-07', 276.1, 'Team 4'),
(42, 2, 5, '2025-01-17', 737.18, 'Team 5'),
(43, 5, 4, '2025-02-01', 795.39, 'Team 4'),
(44, 2, 1, '2025-01-13', 676.03, 'Team 3'),
(45, 4, 4, '2025-03-01', 870.64, 'Team 1'),
(46, 1, 1, '2025-02-21', 741.8, 'Team 1'),
(47, 2, 2, '2025-01-25', 559.47, 'Team 2'),
(48, 4, 2, '2025-02-05', 489.5, 'Team 1'),
(49, 4, 5, '2025-01-13', 98.06, 'Team 5'),
(50, 1, 1, '2025-01-31', 208.0, 'Team 4'),
(51, 4, 2, '2025-02-21', 907.32, 'Team 2'),
(52, 4, 1, '2025-02-19', 301.94, 'Team 4'),
(53, 3, 4, '2025-03-31', 959.45, 'Team 5'),
(54, 4, 2, '2025-01-25', 331.87, 'Team 1'),
(55, 5, 5, '2025-01-08', 760.58, 'Team 1'),
(56, 1, 5, '2025-03-03', 527.71, 'Team 5'),
(57, 2, 1, '2025-03-07', 126.11, 'Team 2'),
(58, 1, 5, '2025-01-09', 691.45, 'Team 2'),
(59, 4, 1, '2025-03-14', 283.9, 'Team 5'),
(60, 1, 5, '2025-01-11', 448.26, 'Team 5'),
(61, 5, 5, '2025-02-10', 937.97, 'Team 2'),
(62, 3, 2, '2025-02-03', 426.0, 'Team 3'),
(63, 4, 3, '2025-01-10', 58.85, 'Team 5'),
(64, 5, 1, '2025-01-10', 560.75, 'Team 5'),
(65, 3, 2, '2025-02-14', 886.82, 'Team 2'),
(66, 3, 3, '2025-01-21', 466.28, 'Team 5'),
(67, 3, 5, '2025-03-25', 552.49, 'Team 5'),
(68, 3, 1, '2025-01-18', 301.24, 'Team 1'),
(69, 5, 2, '2025-02-04', 317.67, 'Team 2'),
(70, 3, 2, '2025-03-29', 652.53, 'Team 3'),
(71, 5, 4, '2025-02-02', 910.07, 'Team 1'),
(72, 1, 4, '2025-02-05', 91.88, 'Team 3'),
(73, 2, 3, '2025-01-21', 754.17, 'Team 5'),
(74, 4, 5, '2025-01-02', 156.28, 'Team 2'),
(75, 5, 1, '2025-02-17', 603.38, 'Team 2'),
(76, 4, 2, '2025-01-06', 342.85, 'Team 1'),
(77, 3, 2, '2025-03-29', 287.05, 'Team 1'),
(78, 3, 5, '2025-02-22', 975.15, 'Team 2'),
(79, 2, 2, '2025-01-23', 887.35, 'Team 1'),
(80, 2, 3, '2025-02-22', 812.12, 'Team 2'),
(81, 3, 2, '2025-03-31', 152.69, 'Team 1'),
(82, 4, 2, '2025-01-26', 825.76, 'Team 4'),
(83, 3, 3, '2025-01-30', 261.78, 'Team 2'),
(84, 4, 3, '2025-02-05', 871.14, 'Team 3'),
(85, 3, 5, '2025-02-21', 695.54, 'Team 5'),
(86, 3, 1, '2025-01-15', 883.19, 'Team 3'),
(87, 2, 5, '2025-02-03', 86.34, 'Team 5'),
(88, 4, 3, '2025-02-10', 464.57, 'Team 5'),
(89, 1, 4, '2025-03-15', 230.57, 'Team 1'),
(90, 4, 1, '2025-03-08', 929.3, 'Team 5'),
(91, 2, 3, '2025-02-25', 116.48, 'Team 3'),
(92, 5, 3, '2025-03-26', 855.61, 'Team 3'),
(93, 5, 3, '2025-03-27', 437.97, 'Team 4'),
(94, 3, 5, '2025-01-17', 232.25, 'Team 4'),
(95, 2, 5, '2025-03-14', 335.9, 'Team 5'),
(96, 1, 3, '2025-02-06', 249.67, 'Team 5'),
(97, 5, 3, '2025-03-01', 469.7, 'Team 2'),
(98, 5, 4, '2025-01-22', 675.91, 'Team 3'),
(99, 5, 5, '2025-02-12', 138.72, 'Team 2'),
(100, 3, 2, '2025-01-26', 189.99, 'Team 1'),
(101, 2, 4, '2025-03-20', 857.25, 'Team 1'),
(102, 4, 4, '2025-03-22', 596.89, 'Team 4'),
(103, 4, 4, '2025-02-01', 190.19, 'Team 1'),
(104, 1, 4, '2025-01-29', 217.09, 'Team 5'),
(105, 4, 1, '2025-03-13', 286.74, 'Team 1'),
(106, 4, 2, '2025-03-01', 684.2, 'Team 5'),
(107, 5, 3, '2025-02-26', 632.02, 'Team 5'),
(108, 4, 5, '2025-02-27', 902.35, 'Team 4'),
(109, 4, 3, '2025-02-01', 847.87, 'Team 3'),
(110, 5, 4, '2025-03-22', 277.28, 'Team 4'),
(111, 1, 3, '2025-01-31', 308.13, 'Team 3'),
(112, 5, 1, '2025-01-18', 193.29, 'Team 4'),
(113, 2, 2, '2025-01-09', 444.12, 'Team 3'),
(114, 5, 4, '2025-02-23', 109.15, 'Team 4'),
(115, 4, 5, '2025-03-31', 68.56, 'Team 5'),
(116, 4, 4, '2025-01-01', 945.6, 'Team 3'),
(117, 4, 4, '2025-03-10', 760.14, 'Team 5'),
(118, 5, 2, '2025-03-04', 258.45, 'Team 4'),
(119, 4, 1, '2025-02-19', 369.32, 'Team 4'),
(120, 2, 4, '2025-01-17', 981.69, 'Team 5'),
(121, 1, 4, '2025-03-17', 586.17, 'Team 1'),
(122, 1, 4, '2025-01-18', 873.51, 'Team 2'),
(123, 1, 3, '2025-02-18', 360.99, 'Team 4'),
(124, 3, 3, '2025-02-18', 314.34, 'Team 4'),
(125, 3, 1, '2025-03-02', 68.41, 'Team 5'),
(126, 1, 3, '2025-01-29', 667.64, 'Team 1'),
(127, 1, 2, '2025-01-26', 847.27, 'Team 5'),
(128, 2, 2, '2025-01-17', 499.88, 'Team 1'),
(129, 5, 2, '2025-03-01', 714.49, 'Team 3'),
(130, 2, 5, '2025-03-19', 965.55, 'Team 1'),
(131, 2, 3, '2025-01-14', 599.75, 'Team 3'),
(132, 5, 4, '2025-02-20', 944.4, 'Team 2'),
(133, 1, 5, '2025-03-30', 839.04, 'Team 2'),
(134, 1, 3, '2025-03-29', 620.39, 'Team 1'),
(135, 5, 1, '2025-02-14', 556.11, 'Team 3'),
(136, 1, 5, '2025-03-24', 374.17, 'Team 4'),
(137, 4, 1, '2025-02-25', 962.75, 'Team 4'),
(138, 2, 4, '2025-01-23', 747.11, 'Team 3'),
(139, 5, 5, '2025-03-03', 491.63, 'Team 5'),
(140, 3, 3, '2025-02-01', 839.19, 'Team 1'),
(141, 3, 4, '2025-02-01', 762.95, 'Team 5'),
(142, 5, 4, '2025-02-13', 77.26, 'Team 3'),
(143, 2, 4, '2025-01-28', 387.08, 'Team 3'),
(144, 3, 3, '2025-03-18', 716.12, 'Team 3'),
(145, 5, 1, '2025-03-08', 950.66, 'Team 1'),
(146, 2, 4, '2025-03-04', 577.42, 'Team 2'),
(147, 4, 4, '2025-02-27', 803.29, 'Team 1'),
(148, 3, 2, '2025-02-21', 707.2, 'Team 3'),
(149, 5, 3, '2025-03-02', 575.8, 'Team 3'),
(150, 4, 5, '2025-02-12', 384.22, 'Team 4'),
(151, 3, 3, '2025-02-02', 269.01, 'Team 2'),
(152, 3, 1, '2025-03-10', 953.33, 'Team 2'),
(153, 2, 2, '2025-03-03', 312.67, 'Team 5'),
(154, 5, 5, '2025-02-06', 981.49, 'Team 2'),
(155, 3, 2, '2025-02-16', 220.47, 'Team 1'),
(156, 5, 2, '2025-02-05', 93.24, 'Team 1'),
(157, 5, 3, '2025-03-31', 946.89, 'Team 4'),
(158, 1, 1, '2025-03-15', 320.12, 'Team 4'),
(159, 4, 3, '2025-01-24', 967.22, 'Team 3'),
(160, 4, 1, '2025-01-09', 430.67, 'Team 1'),
(161, 5, 1, '2025-01-20', 191.74, 'Team 5'),
(162, 3, 1, '2025-02-01', 162.53, 'Team 4'),
(163, 5, 5, '2025-03-21', 264.4, 'Team 5'),
(164, 4, 4, '2025-02-26', 332.49, 'Team 5'),
(165, 4, 3, '2025-03-14', 639.98, 'Team 5'),
(166, 1, 2, '2025-03-22', 250.47, 'Team 1'),
(167, 2, 2, '2025-01-23', 574.39, 'Team 2'),
(168, 1, 4, '2025-02-27', 704.9, 'Team 4'),
(169, 3, 1, '2025-01-30', 323.7, 'Team 3'),
(170, 4, 1, '2025-03-29', 271.75, 'Team 3'),
(171, 5, 2, '2025-02-24', 159.04, 'Team 2'),
(172, 2, 3, '2025-01-19', 117.84, 'Team 2'),
(173, 3, 5, '2025-03-14', 925.13, 'Team 4'),
(174, 1, 4, '2025-03-30', 338.89, 'Team 4'),
(175, 3, 5, '2025-03-11', 519.11, 'Team 1'),
(176, 5, 1, '2025-02-25', 747.81, 'Team 5'),
(177, 3, 1, '2025-01-12', 267.48, 'Team 5'),
(178, 5, 1, '2025-03-28', 830.35, 'Team 5'),
(179, 1, 2, '2025-03-02', 543.02, 'Team 4'),
(180, 3, 2, '2025-03-16', 464.09, 'Team 4'),
(181, 1, 4, '2025-02-14', 437.93, 'Team 3'),
(182, 1, 2, '2025-02-12', 441.06, 'Team 4'),
(183, 3, 4, '2025-03-12', 84.86, 'Team 1'),
(184, 3, 3, '2025-02-11', 160.13, 'Team 4'),
(185, 5, 1, '2025-03-26', 875.9, 'Team 4'),
(186, 4, 1, '2025-01-25', 542.52, 'Team 5'),
(187, 4, 4, '2025-01-07', 243.38, 'Team 5'),
(188, 2, 3, '2025-02-26', 886.8, 'Team 4'),
(189, 1, 1, '2025-03-22', 628.43, 'Team 2'),
(190, 2, 3, '2025-03-12', 62.99, 'Team 4'),
(191, 1, 2, '2025-01-15', 488.38, 'Team 1'),
(192, 2, 4, '2025-02-07', 533.43, 'Team 3'),
(193, 4, 4, '2025-03-02', 281.54, 'Team 5'),
(194, 2, 4, '2025-01-25', 925.77, 'Team 5'),
(195, 2, 1, '2025-02-05', 784.04, 'Team 4'),
(196, 3, 5, '2025-02-04', 829.52, 'Team 3'),
(197, 3, 5, '2025-03-16', 998.96, 'Team 4'),
(198, 2, 4, '2025-03-10', 510.12, 'Team 3'),
(199, 5, 5, '2025-02-18', 482.58, 'Team 3'),
(200, 2, 2, '2025-03-15', 413.82, 'Team 4');

-- Recycling Facilities
INSERT INTO RecyclingFacilities VALUES
(1, 'St. Johns Central', 1, 1, 5000),
(2, 'Mount Pearl Recycling', 2, 2, 3000),
(3, 'Corner Brook Plant', 3, 3, 2000),
(4, 'Gander Facility', 4, 4, 1500),
(5, 'Grand Falls Facility', 5, 5, 1800);

-- 3. SAMPLE QUERIES

-- Total waste collected by city
SELECT c.city_name, SUM(w.amount_kg) AS total_waste
FROM WasteCollection w
JOIN Cities c ON w.city_id = c.city_id
GROUP BY c.city_name
ORDER BY total_waste DESC;

-- Top 3 most collected waste types
SELECT Top 3 wt.waste_name, SUM(w.amount_kg) AS total_collected
FROM WasteCollection w
JOIN WasteTypes wt ON w.waste_type_id = wt.waste_type_id
GROUP BY wt.waste_name
ORDER BY total_collected DESC


-- Average waste per collection team
SELECT collected_by, AVG(amount_kg) AS avg_collection
FROM WasteCollection
GROUP BY collected_by
ORDER BY avg_collection DESC;

-- Daily collection trends for a city (e.g., city_id = 1)
SELECT collection_date, SUM(amount_kg) AS total_daily_waste
FROM WasteCollection
WHERE city_id = 1
GROUP BY collection_date
ORDER BY collection_date;

-- Recycling facility capacity utilization
SELECT rf.facility_name, SUM(w.amount_kg)/rf.capacity_kg * 100 AS utilization_percentage
FROM RecyclingFacilities rf
JOIN WasteCollection w 
  ON rf.city_id = w.city_id AND rf.waste_type_id = w.waste_type_id
GROUP BY rf.facility_name, rf.capacity_kg
ORDER BY utilization_percentage DESC;
